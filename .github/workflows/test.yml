name: Test Setup KubeSolo Action

on:
  push:
    branches:
      - main
  pull_request:
  workflow_dispatch:

# Cancel in-progress runs for the same workflow on the same branch
concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

jobs:
  test-basic-setup:
    runs-on: ubuntu-latest
    name: Test KubeSolo Setup
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Setup KubeSolo
        id: kubesolo
        uses: ./
      
      - name: Verify cluster with kubectl
        env:
          KUBECONFIG: ${{ steps.kubesolo.outputs.kubeconfig }}
        run: |
          echo "Testing kubectl connectivity..."
          kubectl cluster-info
          kubectl get nodes
          kubectl get pods -A

